<?xml version="1.0"?>
<robot name="rovi">
  <material name="Green">
    <color rgba="0 0.7 0 1"/>
  </material>
  <material name="White">
    <color rgba="0.7 0.7 0.7 1"/>
  </material>

  <link name="base_footprint"/>
  <link name="imu_link"/>

  <link name="base_link">
    <inertial>
      <origin xyz="0.00498197982182523 0.0000570233829969297 -0.0121008098068578" rpy="0 0 0"/>
      <mass value="0.486218814966626"/>
      <inertia ixx="0.00196277727666921" ixy="0.000000250447049446755" ixz="0.000140534767811098"
               iyy="0.00457256033711368" iyz="0.000000268618064993882" izz="0.00493927269870476"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/chassis.stl"/>
      </geometry>
      <material name="Green"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/chassis.stl"/>
      </geometry>
    </collision>
  </link>

  <joint name="base_joint" type="fixed">
    <parent link="base_footprint"/>
    <child link="base_link"/>
    <origin xyz="0.0 0.0 0.029" rpy="0 0 0"/>
  </joint>

  <joint name="base_imu" type="fixed">
    <parent link="base_link"/>
    <child link="imu_link"/>
    <origin xyz="0.06 0.03 0.01" rpy="0 0 0"/>
  </joint>

  <link name="front_right_wheel">
    <inertial>
      <origin xyz="0.0000019051 -0.00000023183 -0.00064079" rpy="0 0 0"/>
      <mass value="0.051532"/>
      <inertia ixx="0.000014595" ixy="-0.00000000043975" ixz="0.0000000004415"
               iyy="0.000014594" iyz="-0.0000000017476" izz="0.000024264"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RL_FR.stl"/>
      </geometry>
      <material name="White"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RL_FR.stl"/>
      </geometry>
    </collision>
  </link>

  <joint name="front_right_joint" type="continuous">
    <parent link="base_link"/>
    <child link="front_right_wheel"/>
    <origin xyz="0.13902 -0.10414 0.010269" rpy="-1.57079632679 0 3.14159265359"/>
    <axis xyz="0 0 1"/>
    <dynamics damping="0.1"/>
    <limit lower="-3.14159265359" upper="3.14159265359" effort="100" velocity="1"/>
  </joint>

  <link name="front_left_wheel">
    <inertial>
      <origin xyz="0.0000023728 -0.00000094228 0.00064068" rpy="0 0 0"/>
      <mass value="0.051543"/>
      <inertia ixx="0.000014597" ixy="-0.00000000047945" ixz="-0.00000000024786"
               iyy="0.000014598" iyz="0.0000000017972" izz="0.000024267"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RR_FL.stl"/>
      </geometry>
      <material name="White"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RR_FL.stl"/>
      </geometry>
    </collision>
  </link>

  <joint name="front_left_joint" type="continuous">
    <parent link="base_link"/>
    <child link="front_left_wheel"/>
    <origin xyz="0.139 0.10406 0.0139" rpy="1.57079632679 0 0"/>
    <axis xyz="0 0 1"/>
    <dynamics damping="0.1"/>
    <limit lower="-3.14159265359" upper="3.14159265359" effort="100" velocity="1"/>
  </joint>

  <link name="back_right_wheel">
    <inertial>
      <origin xyz="-0.00000175924169923403 0.00000128388821071107 -0.000590549296238266" rpy="0 0 0"/>
      <mass value="0.051540174053366"/>
      <inertia ixx="0.0000145974152250002" ixy="0.000000000194850559178397" ixz="-0.00000000161846387282284"
               iyy="0.000014596501955693" iyz="-0.000000000627904057423818" izz="0.0000242663091380451"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RR_FL.stl"/>
      </geometry>
      <material name="White"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RR_FL.stl"/>
      </geometry>
    </collision>
  </link>

  <joint name="back_right_joint" type="continuous">
    <parent link="base_link"/>
    <child link="back_right_wheel"/>
    <origin xyz="-0.080231 -0.1041 0.0135" rpy="-1.57079632679 0 3.14159265359"/>
    <axis xyz="0 0 1"/>
    <dynamics damping="0.1"/>
    <limit lower="-3.14159265359" upper="3.14159265359" effort="100" velocity="1"/>
  </joint>

  <link name="back_left_wheel">
    <inertial>
      <origin xyz="-0.000000401213085227115 0.00000204910264598596 0.000590775697051377" rpy="0 0 0"/>
      <mass value="0.0515309299357028"/>
      <inertia ixx="0.0000145942986129926" ixy="-0.000000000319787215398093" ixz="0.00000000174943062058915"
               iyy="0.0000145948727598913" iyz="0.000000000161769812110049" izz="0.000024263683888153"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RL_FR.stl"/>
      </geometry>
      <material name="White"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/mecanum/wheel_RL_FR.stl"/>
      </geometry>
    </collision>
  </link>

  <joint name="back_left_joint" type="continuous">
    <parent link="base_link"/>
    <child link="back_left_wheel"/>
    <origin xyz="-0.08231 0.1041 0.0135" rpy="1.57079632679 0 0"/>
    <axis xyz="0 0 1"/>
    <dynamics damping="0.1"/>
    <limit lower="-3.14159265359" upper="3.14159265359" effort="100" velocity="1"/>
  </joint>

  <link name="laser_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 -3.14159"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/sensor/laser_link.STL"/>
      </geometry>
      <material name="White"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rovi_description/meshes/sensor/laser_link.STL"/>
      </geometry>
    </collision>
  </link>

  <joint name="laser_joint" type="fixed">
    <parent link="base_link"/>
    <child link="laser_link"/>
    <origin xyz="0.129 0 0.1645" rpy="0 0 3.14159"/>
  </joint>

  <!-- Gazebo Sim extensions (ignored by robot_state_publisher / RViz) -->

  <!-- Holonomic base motion (X/Y + yaw) driven by gz.msgs.Twist on /model/<name>/cmd_vel -->
  <gazebo>
    <plugin filename="gz-sim-velocity-control-system" name="gz::sim::systems::VelocityControl"/>
    <!-- Publish ground-truth odometry on Gazebo Transport (/model/<name>/odometry) -->
    <plugin filename="gz-sim-odometry-publisher-system" name="gz::sim::systems::OdometryPublisher">
      <dimensions>3</dimensions>
    </plugin>
  </gazebo>

  <!-- Simulated LiDAR publishing on Gazebo Transport topic /rovi/scan -->
  <gazebo reference="laser_link">
    <sensor name="rovi_lidar" type="gpu_lidar">
      <always_on>true</always_on>
      <visualize>true</visualize>
      <update_rate>10</update_rate>
      <topic>/rovi/scan</topic>
      <gz_frame_id>laser_link</gz_frame_id>
      <ray>
        <scan>
          <horizontal>
            <samples>360</samples>
            <resolution>1</resolution>
            <min_angle>0.0</min_angle>
            <max_angle>6.28318530718</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.05</min>
          <max>12.0</max>
          <resolution>0.01</resolution>
        </range>
        <noise>
          <type>gaussian</type>
          <mean>0.0</mean>
          <stddev>0.01</stddev>
        </noise>
      </ray>
    </sensor>
  </gazebo>

  <!-- Simulated IMU publishing on Gazebo Transport topic /rovi/imu -->
  <gazebo reference="imu_link">
    <sensor name="rovi_imu" type="imu">
      <always_on>true</always_on>
      <visualize>false</visualize>
      <update_rate>100</update_rate>
      <topic>/rovi/imu</topic>
      <gz_frame_id>imu_link</gz_frame_id>
    </sensor>
  </gazebo>
</robot>
