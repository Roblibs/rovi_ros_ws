<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="670px" preserveAspectRatio="none" style="width:1592px;height:670px;background:#FFFFFF;" version="1.1" viewBox="0 0 1592 670" width="1592px" zoomAndPan="magnify"><title>robot_mode flow (backend selection + stable contract)</title><defs/><g><g class="title" data-source-line="1"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="433.5557" x="572.2222" y="22.9951">robot_mode flow (backend selection + stable contract)</text></g><!--cluster Backends--><g class="cluster" data-entity="Backends" data-source-line="24" data-uid="ent0004" id="cluster_Backends"><rect fill="#F8F8F8" height="297" rx="6" ry="6" style="stroke:#666666;stroke-width:1;" width="268" x="838" y="44.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="173.3457" x="885.3271" y="59.292">robot_mode backends</text></g><!--cluster Contract--><g class="cluster" data-entity="Contract" data-source-line="30" data-uid="ent0008" id="cluster_Contract"><rect fill="#F8F8F8" height="238" rx="6" ry="6" style="stroke:#666666;stroke-width:1;" width="276" x="834.5" y="365.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="260.0459" x="842.4771" y="380.292">Robot interface contract (stable)</text></g><!--cluster Stacks--><g class="cluster" data-entity="Stacks" data-source-line="35" data-uid="ent0011" id="cluster_Stacks"><rect fill="#F8F8F8" height="352" rx="6" ry="6" style="stroke:#666666;stroke-width:1;" width="292" x="1294" y="312.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="276.165" x="1301.9175" y="327.292">Mode-agnostic stacks (unchanged)</text></g><!--entity Real--><g class="entity" data-entity="Real" data-source-line="25" data-uid="ent0005" id="entity_Real"><rect fill="#E8F5E9" height="52.5938" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="234.0605" x="855" y="79.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.8379" x="958.6113" y="102.792">real</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.0605" x="865" y="119.0889">rosmaster_driver + rplidar_ros</text></g><!--entity Sim--><g class="entity" data-entity="Sim" data-source-line="26" data-uid="ent0006" id="entity_Sim"><rect fill="#E3F2FD" height="68.8906" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="235.708" x="854" y="167.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24.8213" x="959.4434" y="190.792">sim</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="201.1064" x="871.3008" y="207.0889">Gazebo Sim + ros_gz_bridge</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="215.708" x="864" y="223.3857">rovi_sim_base + rovi_gz_odom</text></g><!--entity Offline--><g class="entity" data-entity="Offline" data-source-line="27" data-uid="ent0007" id="entity_Offline"><rect fill="#FFF8E1" height="52.5938" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="169.3926" x="887.5" y="271.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.6885" x="950.3521" y="294.792">offline</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.3926" x="897.5" y="311.0889">URDF inspection only</text></g><!--entity CMD--><g class="entity" data-entity="CMD" data-source-line="31" data-uid="ent0009" id="entity_CMD"><path d="M935.5,400.7969 L1008.2266,400.7969 C1013.2266,400.7969 1013.2266,422.0938 1013.2266,422.0938 C1013.2266,422.0938 1013.2266,443.3906 1008.2266,443.3906 L935.5,443.3906 C930.5,443.3906 930.5,422.0938 930.5,422.0938 C930.5,422.0938 930.5,400.7969 935.5,400.7969" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M1008.2266,400.7969 C1003.2266,400.7969 1003.2266,422.0938 1003.2266,422.0938 C1003.2266,443.3906 1008.2266,443.3906 1008.2266,443.3906" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.7266" x="935.5" y="418.792">/cmd_vel</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.5986" x="943.064" y="435.0889">(Twist)</text></g><!--entity Feedback--><g class="entity" data-entity="Feedback" data-source-line="32" data-uid="ent0010" id="entity_Feedback"><path d="M885.5,479.2969 L1058.2842,479.2969 C1063.2842,479.2969 1063.2842,533.1875 1063.2842,533.1875 C1063.2842,533.1875 1063.2842,587.0781 1058.2842,587.0781 L885.5,587.0781 C880.5,587.0781 880.5,533.1875 880.5,533.1875 C880.5,533.1875 880.5,479.2969 885.5,479.2969" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M1058.2842,479.2969 C1053.2842,479.2969 1053.2842,533.1875 1053.2842,533.1875 C1053.2842,587.0781 1058.2842,587.0781 1058.2842,587.0781" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.9971" x="911.8936" y="497.292">Robot feedback</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.6123" x="904.5859" y="513.5889">/scan (LaserScan)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.167" x="895.8086" y="529.8857">/imu/data_raw (Imu)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.3389" x="911.7227" y="546.1826">/vel_raw (Twist)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162.7842" x="885.5" y="562.4795">/odom_raw (Odometry)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.9326" x="909.4258" y="578.7764">/clock (sim only)</text></g><!--entity EKF--><g class="entity" data-entity="EKF" data-source-line="36" data-uid="ent0012" id="entity_EKF"><rect fill="#FFFFFF" height="52.5938" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="132.752" x="1373" y="418.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.752" x="1383" y="441.792">rovi_localization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.0029" x="1420.8745" y="458.0889">(EKF)</text></g><!--entity SLAM--><g class="entity" data-entity="SLAM" data-source-line="37" data-uid="ent0013" id="entity_SLAM"><rect fill="#FFFFFF" height="52.5938" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="123.5713" x="1377.5" y="506.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8965" x="1405.8374" y="529.792">rovi_slam</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.5713" x="1387.5" y="546.0889">(slam_toolbox)</text></g><!--entity NAV--><g class="entity" data-entity="NAV" data-source-line="38" data-uid="ent0014" id="entity_NAV"><rect fill="#FFFFFF" height="52.5938" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="79.2334" x="1400" y="594.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.2334" x="1410" y="617.792">rovi_nav</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.168" x="1416.0327" y="634.0889">(Nav2)</text></g><!--entity RVIZ--><g class="entity" data-entity="RVIZ" data-source-line="39" data-uid="ent0015" id="entity_RVIZ"><rect fill="#FFFFFF" height="36.2969" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="54.1865" x="1412.5" y="347.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.1865" x="1422.5" y="370.292">rviz2</text></g><!--entity Rovi--><g class="entity" data-entity="Rovi" data-source-line="21" data-uid="ent0002" id="entity_Rovi"><rect fill="#FFFFFF" height="52.5938" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="211.6182" x="7" y="175.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191.6182" x="17" y="198.792">rovi_bringup/rovi.launch.py</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.001" x="65.8086" y="215.0889">(stack + rviz)</text></g><!--entity RobotBringup--><g class="entity" data-entity="RobotBringup" data-source-line="22" data-uid="ent0003" id="entity_RobotBringup"><rect fill="#FFFFFF" height="52.5938" rx="6" ry="6" style="stroke:#444444;stroke-width:0.5;" width="283.4365" x="375" y="175.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="263.4365" x="385" y="198.792">rovi_bringup/robot_bringup.launch.py</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219.3516" x="407.0425" y="215.0889">(robot_mode backend selector)</text></g><!--link Rovi to RobotBringup--><g class="link" data-entity-1="Rovi" data-entity-2="RobotBringup" data-source-line="42" data-uid="lnk16" id="link_Rovi_RobotBringup"><path d="M219.23,202.2969 C266.74,202.2969 317.56,202.2969 368.68,202.2969" fill="none" id="Rovi-to-RobotBringup" style="stroke:#444444;stroke-width:1.2;stroke-dasharray:7,7;"/><polygon fill="#444444" points="374.68,202.2969,365.68,198.2969,369.68,202.2969,365.68,206.2969,374.68,202.2969" style="stroke:#444444;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.5928" x="250" y="198.3638">include + args</text></g><!--link RobotBringup to Real--><g class="link" data-entity-1="RobotBringup" data-entity-2="Real" data-source-line="44" data-uid="lnk17" id="link_RobotBringup_Real"><path d="M642.92,175.7469 C709.25,161.7069 784.2601,145.8295 849.1201,132.0995" fill="none" id="RobotBringup-to-Real" style="stroke:#444444;stroke-width:1.2;stroke-dasharray:7,7;"/><polygon fill="#444444" points="854.99,130.8569,845.3567,128.8075,850.0984,131.8924,847.0135,136.634,854.99,130.8569" style="stroke:#444444;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.7817" x="697" y="136.3638">robot_mode=real</text></g><!--link RobotBringup to Sim--><g class="link" data-entity-1="RobotBringup" data-entity-2="Sim" data-source-line="45" data-uid="lnk18" id="link_RobotBringup_Sim"><path d="M658.19,202.2969 C721,202.2969 788.15,202.2969 847.92,202.2969" fill="none" id="RobotBringup-to-Sim" style="stroke:#444444;stroke-width:1.2;stroke-dasharray:7,7;"/><polygon fill="#444444" points="853.92,202.2969,844.92,198.2969,848.92,202.2969,844.92,206.2969,853.92,202.2969" style="stroke:#444444;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.9092" x="698" y="198.3638">robot_mode=sim</text></g><!--link RobotBringup to Offline--><g class="link" data-entity-1="RobotBringup" data-entity-2="Offline" data-source-line="46" data-uid="lnk19" id="link_RobotBringup_Offline"><path d="M642.92,228.8469 C720.78,245.3269 812.84,264.8145 881.35,279.3145" fill="none" id="RobotBringup-to-Offline" style="stroke:#444444;stroke-width:1.2;stroke-dasharray:7,7;"/><polygon fill="#444444" points="887.22,280.5569,879.2433,274.78,882.3284,279.5216,877.5868,282.6066,887.22,280.5569" style="stroke:#444444;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.4287" x="689" y="235.3638">robot_mode=offline</text></g><!--link CMD to Real--><g class="link" data-entity-1="CMD" data-entity-2="Real" data-source-line="48" data-uid="lnk20" id="link_CMD_Real"><path d="M930.11,417.9969 C876.07,409.9469 784.05,387.2069 742.25,323.7969 C704.09,265.9169 700.04,222.7969 742.25,167.7969 C768.84,133.1569 806.7512,117.6892 849.0412,110.2292" fill="none" id="CMD-to-Real" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="854.95,109.1869,845.392,106.8112,850.026,110.0555,846.7817,114.6895,854.95,109.1869" style="stroke:#444444;stroke-width:1.2;"/></g><!--link CMD to Sim--><g class="link" data-entity-1="CMD" data-entity-2="Sim" data-source-line="49" data-uid="lnk21" id="link_CMD_Sim"><path d="M930.26,413.5969 C849.98,394.9469 686.69,346.6469 742.25,271.7969 C768.33,236.6669 805.8035,219.9153 847.8535,210.8953" fill="none" id="CMD-to-Sim" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="853.72,209.6369,844.0812,207.6135,848.8312,210.6856,845.7591,215.4355,853.72,209.6369" style="stroke:#444444;stroke-width:1.2;"/></g><!--link Real to Feedback--><g class="link" data-entity-1="Real" data-entity-2="Feedback" data-source-line="51" data-uid="lnk22" id="link_Real_Feedback"><path d="M854.95,109.1869 C812.66,116.6469 768.84,133.1569 742.25,167.7969 C667.56,265.1069 673.02,342.5369 742.25,443.7969 C773.17,489.0269 824.7532,510.1038 874.4632,521.1638" fill="none" id="Real-to-Feedback" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="880.32,522.4669,872.4035,516.6077,875.4393,521.381,870.6661,524.4168,880.32,522.4669" style="stroke:#444444;stroke-width:1.2;"/></g><!--link Sim to Feedback--><g class="link" data-entity-1="Sim" data-entity-2="Feedback" data-source-line="52" data-uid="lnk23" id="link_Sim_Feedback"><path d="M853.72,209.6369 C811.67,218.6569 768.33,236.6669 742.25,271.7969 C696.69,333.1769 699.11,380.6869 742.25,443.7969 C773.17,489.0269 824.7532,510.1038 874.4632,521.1638" fill="none" id="Sim-to-Feedback" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="880.32,522.4669,872.4035,516.6077,875.4393,521.381,870.6661,524.4168,880.32,522.4669" style="stroke:#444444;stroke-width:1.2;"/></g><!--link Feedback to EKF--><g class="link" data-entity-1="Feedback" data-entity-2="EKF" data-source-line="54" data-uid="lnk24" id="link_Feedback_EKF"><path d="M1063.58,516.1769 C1154.43,498.9969 1286.2344,474.0811 1367.0344,458.8111" fill="none" id="Feedback-to-EKF" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="1372.93,457.6969,1363.3437,455.4377,1368.017,458.6254,1364.8293,463.2986,1372.93,457.6969" style="stroke:#444444;stroke-width:1.2;"/></g><!--link Feedback to SLAM--><g class="link" data-entity-1="Feedback" data-entity-2="SLAM" data-source-line="55" data-uid="lnk25" id="link_Feedback_SLAM"><path d="M1063.58,533.2969 C1156.15,533.2969 1291.36,533.2969 1371.45,533.2969" fill="none" id="Feedback-to-SLAM" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="1377.45,533.2969,1368.45,529.2969,1372.45,533.2969,1368.45,537.2969,1377.45,533.2969" style="stroke:#444444;stroke-width:1.2;"/></g><!--link Feedback to NAV--><g class="link" data-entity-1="Feedback" data-entity-2="NAV" data-source-line="56" data-uid="lnk26" id="link_Feedback_NAV"><path d="M1063.58,550.4169 C1165.54,569.6969 1320.6144,599.0123 1393.9244,612.8723" fill="none" id="Feedback-to-NAV" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="1399.82,613.9869,1391.7197,608.3846,1394.907,613.058,1390.2336,616.2453,1399.82,613.9869" style="stroke:#444444;stroke-width:1.2;"/></g><!--link Feedback to RVIZ--><g class="link" data-entity-1="Feedback" data-entity-2="RVIZ" data-source-line="57" data-uid="lnk27" id="link_Feedback_RVIZ"><path d="M1063.67,489.4469 C1125.23,461.0869 1209.11,425.1469 1286,401.2969 C1329.65,387.7569 1375.8076,377.6687 1406.4176,371.5187" fill="none" id="Feedback-to-RVIZ" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="1412.3,370.3369,1402.6884,368.188,1407.398,371.3218,1404.2642,376.0313,1412.3,370.3369" style="stroke:#444444;stroke-width:1.2;"/></g><!--link Offline to RVIZ--><g class="link" data-entity-1="Offline" data-entity-2="RVIZ" data-source-line="59" data-uid="lnk28" id="link_Offline_RVIZ"><path d="M1056.76,310.3569 C1164.34,325.8369 1339.2512,351.0119 1406.4212,360.6819" fill="none" id="Offline-to-RVIZ" style="stroke:#444444;stroke-width:1.2;"/><polygon fill="#444444" points="1412.36,361.5369,1404.0218,356.2952,1407.411,360.8244,1402.8819,364.2136,1412.36,361.5369" style="stroke:#444444;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.9727" x="1127" y="316.3638">/robot_description + /tf</text></g><!--SRC=[VLLjRzem4FwUNs6rNwYcWifUr5NQ95fWgjQN2Rf-c90YOpl1mh6PxK1Xsd_VdPtG1Ae52NntpxqzTmvUUYM8DNFZqy9mGJ9bDgGpfsmfD2TEAC6yD9gy8yxJEM2PqTvIviyI9J9Fl25MvWjFkBGHcYHkAVMAMbeGjw3SRAJEIKQL4mtBK6IqLFv9lFY1ahakXFQ4mPUm3TJ0MhEvCSfOSleXF8V6fuLaIosS8nVTViFu0pgWkPZwBVO7bL6TgsO1aretCQNcDyPgOSb5lrdztetyIGYvDfOBsou6j90djp54i8p3a_nj1bh5OcAO8uTB_1mc-1GU3FDQnOarQvdEBV1PhdeeT1KjDLjqLzkPxi20s186PTToTtP2g2CJWFp77uTUIQr0ZNLeBuAnTLm0N4VF9AcxEpdsSm5-NGcX_sOvWggPjiOLrC7SKsxb6eO07QoKvDIcO8hv04XEHvVZZwFFxH1E5ZFzZUx4t92fBD3Nk3JVOLyy5nWTMWPKEgTE13F8O3VS524sUfsEte_xus4xjCao9JM4-3aPZedKRbLT1QFLDhW-HaIO-UNe0eUrvo9G15xGLqRPwxKXdNYF8f4tjHQP-LsA4ZnxhE3fMW0pdQUDTBv2tWzV8J5u9WH7dcUwvnZLf7C7BTef7Cz09OkonwcdgQLmeM-B4fKGDienCcYGXwXwX9FmTejQfWoiKWTu2zt64iPLlbQVzp3jSvfhuxna9AoW8ntS9Q1HyEWvZUh3yUCe815LSaUHMUXuz7qSNU3m1jefMk2cmq_gZL5pyr9bk1lSlu7NT0tm1xhkHzZ3uFa01NUb7tVi-VONTePtXdIxNrjBJgvWb4oL75U8sjmXhc4EU5pIgyQxz0lkzp4E5wu50vQFKVLkjP3LIYO9R0CvFuyvzm84XhAm2fJsqy9yBKLIdu8QYMuf0fKj3RBMKWIkahh4MWErLYyLBXopSbNzSVHyzWy0]--></g></svg>